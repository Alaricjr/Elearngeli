<mat-form-field class="search">
  <input matInput placeholder="Search and add {{role}}s by name, Id, e-mail"
         [matAutocomplete]="auto" [formControl]="userCtrl" [(ngModel)]="searchString">
</mat-form-field>

<mat-autocomplete #auto="matAutocomplete">
  <mat-option *ngFor="let state of filteredStates | async" [value]="state">
    {{ state }}
  </mat-option>
</mat-autocomplete>

<div class="members" *ngIf="search.length <= 0">
  <app-course-user-list-overview [users]="users" (onUpdate)="updateUser($event)"></app-course-user-list-overview>
</div>

<div class="users" *ngIf="search.length > 0 && finishRestCall">
  <div class="titleHeader"><h3>In course:</h3>
    <button class="open-toggle" (click)="toggle('inCourse')"
            [class.opened]="fieldsToShow.get('inCourse')" mat-icon-button>
      <mat-icon>arrow_drop_down</mat-icon>
    </button>
  </div>

  <ul class="footer">
  <li>{{role}}s: {{dragableUsersInCourse.length}} of
    <ng-container *ngIf="role === 'student'">{{course.students.length}}</ng-container>
  <ng-container *ngIf="role === 'teacher'">{{course.teachers.length}}</ng-container></li>
  <li *ngIf="role === 'student'">whitelist: {{0}} of {{500}}</li>
  </ul>

  <mat-list class="drop" [dragula]='dragulaBagId' [dragulaModel]="dragableUsersInCourse">
    <ng-container *ngIf="fieldsToShow.get('inCourse')">
      <div *ngFor="let member of dragableUsersInCourse">
        <mat-list-item class="list" [attr.item-id]="member._id">
          <mat-icon class="user-drag-handle">drag_handle</mat-icon>
          <span class="listBg" user-image [user-image]="member" [size]="32"></span>
          <span class="firstName">{{member.profile.firstName}}</span>
          <span class="lastName">{{member.profile.lastName}}</span>
          <span class="uid">{{member.uid}}</span>
          <span class="email"><a href="mailto:{{member.email}}">{{member.email}}</a></span>
        </mat-list-item>
      </div>
    </ng-container>
  </mat-list>

  <div class="titleHeader"><h3>Not in course:</h3>
    <button class="open-toggle" (click)="toggle('notInCourse')"
            [class.opened]="fieldsToShow.get('notInCourse')" mat-icon-button>
      <mat-icon>arrow_drop_down</mat-icon>
    </button>
  </div>

  <ul class="footer">
  <li>{{role}}s: {{dragableUsers.length}} of {{usersTotal}}</li>
  <li *ngIf="role === 'student'">blacklist: {{0}} of {{500}} [not implemented]</li>
  </ul>

  <mat-list class="drop" [dragula]='dragulaBagId' [dragulaModel]="dragableUsers">
    <ng-container *ngIf="fieldsToShow.get('notInCourse')">
      <div *ngFor="let user of dragableUsers">
        <mat-list-item class="list" [attr.item-id]="user._id">
          <mat-icon class="member-drag-handle">drag_handle</mat-icon>
          <span class="listBg" user-image [user-image]="user" [size]="32"></span>
          <span class="firstName">{{user.profile.firstName}}</span>
          <span class="lastName">{{user.profile.lastName}}</span>
          <span class="uid">{{user.uid}}</span>
          <span class="email"><a href="mailto:{{user.email}}">{{user.email}}</a></span>
        </mat-list-item>
      </div>
    </ng-container>
  </mat-list>
</div>
